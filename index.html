<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude AI Chat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .app-header {
            background: #0d0d0d;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #2a2a2a;
        }

        .anthropic-logo {
            width: 38px;
            height: 38px;
            background: linear-gradient(135deg, #cc785c, #d4a574);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #fff;
            font-size: 18px;
        }

        .app-title {
            flex: 1;
        }

        .app-title h1 {
            font-size: 18px;
            color: #fff;
            margin-bottom: 2px;
        }

        .app-title p {
            font-size: 12px;
            color: #888;
        }

        .model-selector {
            background: #252525;
            border: 1px solid #3a3a3a;
            padding: 8px 15px;
            border-radius: 8px;
            color: #fff;
            font-size: 13px;
            cursor: pointer;
        }

        .model-selector:focus {
            outline: none;
            border-color: #cc785c;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message-wrapper {
            display: flex;
            gap: 12px;
            max-width: 850px;
            width: 100%;
            margin: 0 auto;
        }

        .message-wrapper.user-message {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 14px;
        }

        .message-avatar.ai-avatar {
            background: linear-gradient(135deg, #cc785c, #d4a574);
            color: #fff;
        }

        .message-avatar.user-avatar {
            background: #3b82f6;
            color: #fff;
        }

        .message-content {
            flex: 1;
            max-width: calc(100% - 50px);
        }

        .message-bubble {
            padding: 14px 18px;
            border-radius: 12px;
            line-height: 1.6;
            font-size: 14px;
        }

        .ai-bubble {
            background: #252525;
            border: 1px solid #3a3a3a;
        }

        .user-bubble {
            background: #3b82f6;
            color: #fff;
        }

        .message-text {
            white-space: pre-wrap;
            word-break: break-word;
        }

        .code-block-collapsed {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 8px;
            margin: 10px 0;
            overflow: hidden;
        }

        .code-block-header {
            background: #2a2a2a;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }

        .code-block-header:hover {
            background: #333;
        }

        .code-block-info {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #aaa;
        }

        .code-block-info i {
            color: #cc785c;
        }

        .code-block-actions {
            display: flex;
            gap: 8px;
        }

        .code-action-btn {
            background: #444;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            color: #ccc;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .code-action-btn:hover {
            background: #555;
            color: #fff;
        }

        .code-preview {
            padding: 10px 15px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 12px;
            color: #888;
            border-top: 1px solid #333;
            max-height: 60px;
            overflow: hidden;
            position: relative;
        }

        .code-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(transparent, #1a1a1a);
        }

        .input-container {
            background: #0d0d0d;
            padding: 20px;
            border-top: 1px solid #2a2a2a;
        }

        .input-wrapper {
            max-width: 850px;
            margin: 0 auto;
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .text-input-container {
            flex: 1;
            background: #252525;
            border: 1px solid #3a3a3a;
            border-radius: 12px;
            padding: 12px 15px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .text-input-container:focus-within {
            border-color: #cc785c;
        }

        .message-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            font-size: 14px;
            resize: none;
            max-height: 150px;
            min-height: 24px;
            line-height: 1.5;
            font-family: inherit;
        }

        .message-input:focus {
            outline: none;
        }

        .message-input::placeholder {
            color: #666;
        }

        .send-button {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #cc785c, #d4a574);
            border: none;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: transform 0.2s, opacity 0.2s;
        }

        .send-button:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 10px 15px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #cc785c;
            border-radius: 50%;
            animation: typingBounce 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingBounce {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-8px);
            }
        }

        .welcome-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }

        .welcome-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #cc785c, #d4a574);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: #fff;
            margin-bottom: 25px;
        }

        .welcome-title {
            font-size: 28px;
            color: #fff;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            font-size: 14px;
            color: #888;
            max-width: 400px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .quick-prompts {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            max-width: 600px;
        }

        .quick-prompt {
            background: #252525;
            border: 1px solid #3a3a3a;
            padding: 10px 18px;
            border-radius: 20px;
            font-size: 13px;
            color: #ccc;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-prompt:hover {
            background: #333;
            border-color: #cc785c;
            color: #fff;
        }

        .hidden {
            display: none;
        }

        .footer-credit {
            text-align: center;
            padding: 10px;
            font-size: 11px;
            color: #555;
            background: #0d0d0d;
        }

        .footer-credit a {
            color: #cc785c;
            text-decoration: none;
        }

        .clear-chat-btn {
            background: #333;
            border: 1px solid #444;
            padding: 8px 15px;
            border-radius: 8px;
            color: #aaa;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .clear-chat-btn:hover {
            background: #444;
            color: #fff;
        }

        @media (max-width: 600px) {
            .app-header {
                padding: 12px 15px;
            }

            .app-title h1 {
                font-size: 16px;
            }

            .model-selector {
                padding: 6px 10px;
                font-size: 11px;
            }

            .chat-container {
                padding: 15px;
            }

            .message-bubble {
                padding: 12px 14px;
                font-size: 13px;
            }

            .input-wrapper {
                gap: 8px;
            }

            .welcome-title {
                font-size: 22px;
            }

            .quick-prompts {
                flex-direction: column;
            }

            .quick-prompt {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <header class="app-header">
        <div class="anthropic-logo">A</div>
        <div class="app-title">
            <h1>Claude AI</h1>
            <p>Powered by Anthropic</p>
        </div>
        <button class="clear-chat-btn" onclick="clearChat()">
            <i class="fas fa-trash-alt"></i>
            Clear
        </button>
        <select class="model-selector" id="modelSelect">
            <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
            <option value="claude-3-5-sonnet">Claude 3.5 Sonnet</option>
            <option value="claude-3-opus">Claude 3 Opus</option>
            <option value="claude-3-haiku">Claude 3 Haiku</option>
        </select>
    </header>

    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-logo">
            <i class="fas fa-brain"></i>
        </div>
        <h2 class="welcome-title">Hello, I'm Claude</h2>
        <p class="welcome-subtitle">
            I'm an AI assistant made by Anthropic. I can help you with writing, analysis, coding, math, and much more.
        </p>
        <div class="quick-prompts">
            <button class="quick-prompt" onclick="sendQuickPrompt('Explain quantum computing in simple terms')">
                <i class="fas fa-atom"></i> Explain quantum computing
            </button>
            <button class="quick-prompt" onclick="sendQuickPrompt('Write a Python function to sort a list')">
                <i class="fas fa-code"></i> Write Python code
            </button>
            <button class="quick-prompt" onclick="sendQuickPrompt('What are the benefits of meditation?')">
                <i class="fas fa-spa"></i> Benefits of meditation
            </button>
            <button class="quick-prompt" onclick="sendQuickPrompt('Help me write a professional email')">
                <i class="fas fa-envelope"></i> Write an email
            </button>
        </div>
    </div>

    <div class="chat-container hidden" id="chatContainer"></div>

    <div class="input-container">
        <div class="input-wrapper">
            <div class="text-input-container">
                <textarea 
                    class="message-input" 
                    id="messageInput" 
                    placeholder="Message Claude..." 
                    rows="1"
                    onkeydown="handleKeyDown(event)"
                    oninput="autoResize(this)"
                ></textarea>
            </div>
            <button class="send-button" id="sendButton" onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <div class="footer-credit">
        Made by <a href="#">dashalostacc</a> on Discord
    </div>

    <script src="https://js.puter.com/v2/"></script>
    <script>
        var chatHistory = [];
        var isGenerating = false;
        var currentController = null;

        var welcomeScreen = document.getElementById('welcomeScreen');
        var chatContainer = document.getElementById('chatContainer');
        var messageInput = document.getElementById('messageInput');
        var sendButton = document.getElementById('sendButton');
        var modelSelect = document.getElementById('modelSelect');

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function sendQuickPrompt(prompt) {
            messageInput.value = prompt;
            sendMessage();
        }

        function clearChat() {
            chatHistory = [];
            chatContainer.innerHTML = '';
            chatContainer.classList.add('hidden');
            welcomeScreen.classList.remove('hidden');
        }

        function showChat() {
            welcomeScreen.classList.add('hidden');
            chatContainer.classList.remove('hidden');
        }

        function createMessageElement(role, content) {
            var wrapper = document.createElement('div');
            wrapper.className = 'message-wrapper ' + (role === 'user' ? 'user-message' : 'ai-message');

            var avatar = document.createElement('div');
            avatar.className = 'message-avatar ' + (role === 'user' ? 'user-avatar' : 'ai-avatar');
            avatar.innerHTML = role === 'user' ? '<i class="fas fa-user"></i>' : 'A';

            var contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';

            var bubble = document.createElement('div');
            bubble.className = 'message-bubble ' + (role === 'user' ? 'user-bubble' : 'ai-bubble');

            var textDiv = document.createElement('div');
            textDiv.className = 'message-text';

            bubble.appendChild(textDiv);
            contentDiv.appendChild(bubble);
            wrapper.appendChild(avatar);
            wrapper.appendChild(contentDiv);

            return { wrapper: wrapper, textDiv: textDiv, bubble: bubble };
        }

        function detectCodeBlocks(text) {
            var codeBlockRegex = /```(\w*)\n([\s\S]*?)```/g;
            var parts = [];
            var lastIndex = 0;
            var match;

            while ((match = codeBlockRegex.exec(text)) !== null) {
                if (match.index > lastIndex) {
                    parts.push({
                        type: 'text',
                        content: text.substring(lastIndex, match.index)
                    });
                }

                parts.push({
                    type: 'code',
                    language: match[1] || 'code',
                    content: match[2]
                });

                lastIndex = match.index + match[0].length;
            }

            if (lastIndex < text.length) {
                parts.push({
                    type: 'text',
                    content: text.substring(lastIndex)
                });
            }

            return parts.length > 0 ? parts : [{ type: 'text', content: text }];
        }

        function createCollapsedCodeBlock(language, code) {
            var block = document.createElement('div');
            block.className = 'code-block-collapsed';

            var lineCount = code.split('\n').length;
            var charCount = code.length;

            var header = document.createElement('div');
            header.className = 'code-block-header';

            var info = document.createElement('div');
            info.className = 'code-block-info';
            info.innerHTML = '<i class="fas fa-code"></i> <span>' + language.toUpperCase() + '</span> <span>• ' + lineCount + ' lines • ' + charCount + ' chars</span>';

            var actions = document.createElement('div');
            actions.className = 'code-block-actions';

            var expandBtn = document.createElement('button');
            expandBtn.className = 'code-action-btn';
            expandBtn.innerHTML = '<i class="fas fa-expand"></i> Open';
            expandBtn.onclick = function(e) {
                e.stopPropagation();
                openCodeInNewTab(language, code);
            };

            var copyBtn = document.createElement('button');
            copyBtn.className = 'code-action-btn';
            copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
            copyBtn.onclick = function(e) {
                e.stopPropagation();
                copyToClipboard(code);
                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied';
                setTimeout(function() {
                    copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copy';
                }, 2000);
            };

            actions.appendChild(expandBtn);
            actions.appendChild(copyBtn);
            header.appendChild(info);
            header.appendChild(actions);

            var preview = document.createElement('div');
            preview.className = 'code-preview';
            preview.textContent = code.substring(0, 200);

            block.appendChild(header);
            block.appendChild(preview);

            return block;
        }

        function openCodeInNewTab(language, code) {
            var newWindow = window.open('', '_blank');
            
            var htmlContent = '<!DOCTYPE html>' +
                '<html lang="en">' +
                '<head>' +
                '<meta charset="UTF-8">' +
                '<meta name="viewport" content="width=device-width, initial-scale=1.0">' +
                '<title>Code - ' + language.toUpperCase() + '</title>' +
                '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">' +
                '<style>' +
                '* { margin: 0; padding: 0; box-sizing: border-box; }' +
                'body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #1a1a1a; color: #e0e0e0; min-height: 100vh; }' +
                '.header { background: #0d0d0d; padding: 15px 25px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #333; }' +
                '.header-left { display: flex; align-items: center; gap: 12px; }' +
                '.lang-badge { background: linear-gradient(135deg, #cc785c, #d4a574); padding: 6px 14px; border-radius: 6px; font-size: 13px; font-weight: bold; color: #fff; }' +
                '.header-info { font-size: 13px; color: #888; }' +
                '.header-actions { display: flex; gap: 10px; }' +
                '.action-btn { background: #333; border: 1px solid #444; padding: 10px 20px; border-radius: 8px; color: #fff; font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.2s; }' +
                '.action-btn:hover { background: #444; }' +
                '.action-btn.primary { background: linear-gradient(135deg, #cc785c, #d4a574); border: none; }' +
                '.action-btn.primary:hover { opacity: 0.9; }' +
                '.code-container { padding: 25px; }' +
                '.code-box { background: #0d0d0d; border: 1px solid #333; border-radius: 10px; overflow: hidden; }' +
                '.code-header { background: #252525; padding: 10px 15px; font-size: 12px; color: #888; border-bottom: 1px solid #333; }' +
                '.code-content { padding: 20px; overflow-x: auto; }' +
                'pre { margin: 0; font-family: "Fira Code", "Consolas", monospace; font-size: 14px; line-height: 1.6; color: #e0e0e0; white-space: pre-wrap; word-break: break-word; }' +
                '.footer { text-align: center; padding: 15px; font-size: 11px; color: #555; }' +
                '.footer a { color: #cc785c; text-decoration: none; }' +
                '</style>' +
                '</head>' +
                '<body>' +
                '<div class="header">' +
                '<div class="header-left">' +
                '<div class="lang-badge">' + language.toUpperCase() + '</div>' +
                '<div class="header-info">' + code.split('\\n').length + ' lines • ' + code.length + ' characters</div>' +
                '</div>' +
                '<div class="header-actions">' +
                '<button class="action-btn" onclick="copyCode()"><i class="fas fa-copy"></i> Copy Code</button>' +
                '<button class="action-btn primary" onclick="downloadCode()"><i class="fas fa-download"></i> Download</button>' +
                '</div>' +
                '</div>' +
                '<div class="code-container">' +
                '<div class="code-box">' +
                '<div class="code-header">Source Code</div>' +
                '<div class="code-content">' +
                '<pre id="codeContent"></pre>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '<div class="footer">Made by <a href="#">dashalostacc</a> on Discord</div>' +
                '<script>' +
                'var codeData = ' + JSON.stringify(code) + ';' +
                'var langData = ' + JSON.stringify(language) + ';' +
                'document.getElementById("codeContent").textContent = codeData;' +
                'function copyCode() {' +
                'navigator.clipboard.writeText(codeData);' +
                'var btn = document.querySelector(".action-btn");' +
                'btn.innerHTML = "<i class=\\"fas fa-check\\"></i> Copied!";' +
                'setTimeout(function() { btn.innerHTML = "<i class=\\"fas fa-copy\\"></i> Copy Code"; }, 2000);' +
                '}' +
                'function downloadCode() {' +
                'var blob = new Blob([codeData], { type: "text/plain" });' +
                'var url = URL.createObjectURL(blob);' +
                'var a = document.createElement("a");' +
                'a.href = url;' +
                'a.download = "code." + (langData || "txt");' +
                'a.click();' +
                'URL.revokeObjectURL(url);' +
                '}' +
                '<\/script>' +
                '</body>' +
                '</html>';

            newWindow.document.write(htmlContent);
            newWindow.document.close();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text);
        }

        function renderMessageContent(textDiv, content) {
            textDiv.innerHTML = '';
            
            var parts = detectCodeBlocks(content);

            for (var i = 0; i < parts.length; i++) {
                var part = parts[i];

                if (part.type === 'text') {
                    var textSpan = document.createElement('span');
                    textSpan.textContent = part.content;
                    textDiv.appendChild(textSpan);
                } else if (part.type === 'code') {
                    var codeBlock = createCollapsedCodeBlock(part.language, part.content);
                    textDiv.appendChild(codeBlock);
                }
            }
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function sendMessage() {
            var userMessage = messageInput.value.trim();

            if (userMessage === '' || isGenerating) {
                return;
            }

            showChat();

            var userElement = createMessageElement('user', userMessage);
            userElement.textDiv.textContent = userMessage;
            chatContainer.appendChild(userElement.wrapper);

            chatHistory.push({
                role: 'user',
                content: userMessage
            });

            messageInput.value = '';
            messageInput.style.height = 'auto';

            isGenerating = true;
            sendButton.disabled = true;

            var aiElement = createMessageElement('assistant', '');
            chatContainer.appendChild(aiElement.wrapper);

            var typingIndicator = document.createElement('div');
            typingIndicator.className = 'typing-indicator';
            typingIndicator.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            aiElement.textDiv.appendChild(typingIndicator);

            scrollToBottom();

            var fullResponse = '';
            var selectedModel = modelSelect.value;

            try {
                var response = await puter.ai.chat(chatHistory, {
                    model: selectedModel,
                    stream: true
                });

                aiElement.textDiv.innerHTML = '';

                for await (var part of response) {
                    if (part && part.text) {
                        fullResponse += part.text;
                        renderMessageContent(aiElement.textDiv, fullResponse);
                        scrollToBottom();
                    }
                }

                chatHistory.push({
                    role: 'assistant',
                    content: fullResponse
                });

            } catch (error) {
                aiElement.textDiv.innerHTML = '';
                var errorSpan = document.createElement('span');
                errorSpan.style.color = '#f87171';
                errorSpan.textContent = 'Error: ' + (error.message || 'Failed to get response');
                aiElement.textDiv.appendChild(errorSpan);
            }

            isGenerating = false;
            sendButton.disabled = false;
            scrollToBottom();
        }
    </script>

</body>
    </html>
